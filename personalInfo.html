<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <style>
      body {
        padding: 40px;
      }
      .form-container {
  
      }
      .w-100 {
        width: 100px;
      }
      .table-text {
        width: 100%;
        padding: 10px 20px;
        border-radius: 4px;
        background-color: lightgray;
      }
      .submit-btn {
        width: 100%;
      }
    </style>
  </head>
   <body>
    <div>
      <div class="mb-3">
        <div class="row d-flex justify-content-center h-100">
          <div class="col">
            <div class="d-flex text-black">
              <div class="flex-shrink-0">
                <img src="https://drive.google.com/uc?export=download&id=1npYVQYa4HGWx6Ig6ki49YtlzTv42TYX4"
                  alt="Generic placeholder image"
                  style="width: 100px; height: 100px; object-fit: cover; border-radius: 10px;">
              </div>
              <div class="flex-grow-1 ms-2">
              <div>
                <h5 class="mb-1">Itosugi Reservation</h5>
                <p class="mb-2 pb-1" style="color: #2b2a2a;">Dinner plan</p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="flex-grow-1">
      <div class="d-flex justify-content-start rounded-3 p-2 mb-2"
        style="background-color: #efefef;">
        <div>
          <p class="small text-muted mb-1">Date</p>
          <p class="mb-0"><?= date ?></p>
        </div>
        <div class="px-4">
          <p class="small text-muted mb-1">Time</p>
          <p class="mb-0"><?= time ?></p>
        </div>
        <div>
          <p class="small text-muted mb-1">Seats</p>
          <p class="mb-0"><?= seats ?> People (counter seat)</p>
        </div>
      </div>
    </div>
    <!-- <span>DATE: <?= date ?></span><br>
    <span>TIME: <?= time ?></span><br>
    <span>SEATS: <?= seats ?></span><br>
    <span>isTable: <?= isTable ?></span><br> -->
    <div class="table-text mb-5">
      Counter seats are already full for this scheduel. Only table seats are available.
    </div>
    <form onsubmit="submitReservation(); return false;" class="form-container row g-3">
      <div class="col-md-6">
        <input id="firstName" type="text" class="form-control" placeholder="First name">
      </div>
      <div class="col-md-6">
        <input id="lastName" type="text" class="form-control" placeholder="Last name">
      </div>
      <div class="col-md-6">
        <input id="phone" type="tel" class="form-control" placeholder="Phone">
      </div>
      <div class="col-md-6">
        <input id="email" type="email" class="form-control" placeholder="Email">
      </div>
      <div class="col-md-6">
        <input id="notes" type="text" class="form-control" placeholder="Add a special request (optional)">
      </div>
      <div class="col-12">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="check1">
          <label class="form-check-label" for="check1">
            I understand that the seat will be served in the table
          </label>
        </div>
      </div>
      <div class="col-12">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="check2">
          <label class="form-check-label" for="check2">
            Please indicate the ages of your children in the request box
          </label>
        </div>
      </div>
      <div class="col-12">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="check3">
          <label class="form-check-label" for="check3">
            Please indicate any alergies in the request box
          </label>
        </div>
      </div>
      <div class="col-12">
        <button type="submit" class="btn btn-dark submit-btn">Complete reservation</button>
      </div>
    </form>
    <input type="hidden" value="<?= date ?>" id="date" />
    <input type="hidden" value="<?= time ?>" id="time" />
    <input type="hidden" value="<?= seats ?>" id="seats" />
    <input type="hidden" value="<?= isTable ?>" id="isTable" />
    <?var url = getUrl();?><input type="hidden" value="<?= url ?>" id="url" />

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
    <script>
     function toLink() {
        var url = document.getElementById("url").value;
        var link = document.createElement('a');
        link.href = url+"?page=formSubmitted";
        link.id = 'linkURL';
        document.body.appendChild(link);
        document.getElementById("linkURL").click();        
      }

     const submitReservation = () => {
        // const name = 'Noda';
        let firstName = $("#firstName").val();
        let lastName = $("#lastName").val();
        let date = $("#date").val();
        let time = $("#time").val();
        let seats = $("#seats").val();
        let isTable = $("#isTable").val();
        let notes = $("#notes").val();
        let email = $("#email").val();
        let phone = $("#phone").val();
        let timeStamp = Date.now();
        let dataToSend = {
          firstName, lastName, date, time, seats, isTable, notes, email, phone, timeStamp,
        }
        google.script.run.withSuccessHandler(slotBooked)
          .addReservation(dataToSend);
        toLink();
        console.log(dataToSend);
        console.log('form submitted');
      }

      const slotBooked = (error) => {
        
      }
     </script>  
   </body>
</html>